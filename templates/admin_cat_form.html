{% extends "base.html" %}
{% block content %}
<h1 class="h5 mb-3">Editar Gato</h1>
<div class="card p-3">
  <form method="post">
    <div class="row g-3">
      <div class="col-md-4">
        <label class="form-label">Dono</label>
        <select class="form-select" name="owner_id" required>
          {% for u in users %}
          <option value="{{ u.id }}" {% if u.id == cat.owner_id %}selected{% endif %}>{{ u.name }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Nome</label>
        <input class="form-control" type="text" name="name" value="{{ cat.name }}" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">Sexo</label>
        <select class="form-select" name="sex">
          <option {% if cat.sex=='Macho' %}selected{% endif %}>Macho</option>
          <option {% if cat.sex=='Fêmea' %}selected{% endif %}>Fêmea</option>
        </select>
      </div>

      <div class="col-md-4">
        <label class="form-label">Raça</label>
        <select class="form-select" name="breed_id" onchange="this.form.submit()">
          {% for b in breeds %}
          <option value="{{ b.id }}" {% if b.id == cat.breed_id %}selected{% endif %}>{{ b.name }}</option>
          {% endfor %}
        </select>
        <small class="text-muted">Ao trocar e salvar, atualize a cor/EMS.</small>
      </div>
      <div class="col-md-4">
        <label class="form-label">Cor</label>
        <select class="form-select" name="color_id">
          {% for col in colors %}
          <option value="{{ col.id }}" {% if col.id == cat.color_id %}selected{% endif %}>{{ col.name }} ({{ col.ems_code }})</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Data nascimento</label>
        <input class="form-control" type="date" name="dob" value="{{ cat.dob }}">
      </div>

      <div class="col-md-4">
        <label class="form-label">Registro - nº</label>
        <input class="form-control" type="text" name="registry_number" value="{{ cat.registry_number }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">Entidade</label>
        <input class="form-control" type="text" name="registry_entity" value="{{ cat.registry_entity }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">Microchip</label>
        <input class="form-control" type="text" name="microchip" value="{{ cat.microchip }}">
      </div>

      <div class="col-md-4">
        <label class="form-label">Castrado</label>
        <select class="form-select" name="neutered">
          <option {% if cat.neutered==0 %}selected{% endif %}>NÃO</option>
          <option {% if cat.neutered==1 %}selected{% endif %}>SIM</option>
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Criador (tipo)</label>
        <select class="form-select" name="breeder_type">
          <option value="eu" {% if cat.breeder_type=='eu' %}selected{% endif %}>Eu mesmo</option>
          <option value="outro" {% if cat.breeder_type=='outro' %}selected{% endif %}>Outro</option>
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Nome do criador</label>
        <input class="form-control" type="text" name="breeder_name" value="{{ cat.breeder_name }}">
      </div>

      <div class="col-md-4">
        <label class="form-label">Pai — Nome</label>
        <input class="form-control" type="text" name="sire_name" value="{{ cat.sire_name }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">Pai — Raça</label>
        <select class="form-select" name="sire_breed_id">
          <option value="">—</option>
          {% for b in breeds %}<option value="{{ b.id }}" {% if cat.sire_breed_id==b.id %}selected{% endif %}>{{ b.name }}</option>{% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Pai — Cor (ID)</label>
        <input class="form-control" type="text" name="sire_color_id" value="{{ cat.sire_color_id or '' }}" placeholder="ID da cor (opcional)">
      </div>

      <div class="col-md-4">
        <label class="form-label">Mãe — Nome</label>
        <input class="form-control" type="text" name="dam_name" value="{{ cat.dam_name }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">Mãe — Raça</label>
        <select class="form-select" name="dam_breed_id">
          <option value="">—</option>
          {% for b in breeds %}<option value="{{ b.id }}" {% if cat.dam_breed_id==b.id %}selected{% endif %}>{{ b.name }}</option>{% endfor %}
        </select>
      </div>
      <div class="col-md-4">
        <label class="form-label">Mãe — Cor (ID)</label>
        <input class="form-control" type="text" name="dam_color_id" value="{{ cat.dam_color_id or '' }}" placeholder="ID da cor (opcional)">
      </div>

      <div class="col-md-4">
        <label class="form-label">Status</label>
        <select class="form-select" name="status">
          <option value="pending" {% if cat.status=='pending' %}selected{% endif %}>Pendente</option>
          <option value="approved" {% if cat.status=='approved' %}selected{% endif %}>Aprovado</option>
          <option value="rejected" {% if cat.status=='rejected' %}selected{% endif %}>Rejeitado</option>
        </select>
      </div>
    </div>
    <div class="mt-3 d-flex gap-2">
      <button class="btn btn-primary" type="submit">Salvar</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('admin_cats') }}">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
